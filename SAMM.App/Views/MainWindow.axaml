<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="680" d:DesignHeight="730"
		xmlns:models="clr-namespace:SAMM.App.Models;assembly=SAMM.App"
		x:DataType="models:MainWindowViewModel" MinHeight="420" MinWidth="800"
		Height="{Binding ManagerSettings.ManagerHeight}" Width="{Binding ManagerSettings.ManagerWidth}"
        x:Class="SAMM.App.Views.MainWindow"
        Title="SA Mod Manager" FontSize="{DynamicResource ADVTheme.FontSize}"
		xmlns:dialogHostAvalonia="clr-namespace:DialogHostAvalonia;assembly=DialogHost.Avalonia"
		xmlns:advconverter="clr-namespace:ADVTheme.Converters;assembly=ADVTheme"
		xmlns:sammconverters="clr-namespace:SAMM.App.Converters">
	<Window.Resources>
		<advconverter:DoubleIncrementConverter x:Key="DialogHostSizeConverter" ModifierMethod="Multiply" ModifierValue="0.9"/>
		<advconverter:DoubleIncrementConverter x:Key="TabWidth" ModifierMethod="Multiply" ModifierValue="1"/>
		
		<sammconverters:ModConfigExists x:Key="ModConfigConverter"/>
		<sammconverters:ValidGameConverter x:Key="ValidateGameConfigConverter"/>
		<sammconverters:ModInfoDescriptionConverter x:Key="ModInfoDescriptionConverter"/>
		<Image x:Key="WindowIcon" Source="avares://SAMM.App/Assets/Icons/SADXModManager.ico"/>

		<ControlTheme x:Key="ModListTheme" TargetType="ListBox">
			<Setter Property="Background" Value="{DynamicResource ADVTheme.Brush.Background.Base}" />
			<Setter Property="BorderBrush" Value="{DynamicResource ADVTheme.Brush.Border.Base}" />
			<Setter Property="BorderThickness" Value="2" />
			<Setter Property="CornerRadius" Value="{DynamicResource ADVTheme.CornerRadius}"/>
			<Setter Property="Padding" Value="4" />
			<Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
			<Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
			<Setter Property="ScrollViewer.IsScrollChainingEnabled" Value="True" />
			<Setter Property="Template">
				<ControlTemplate>
					<Border Name="border" BorderBrush="{TemplateBinding BorderBrush}"
							BorderThickness="{TemplateBinding BorderThickness}"
							CornerRadius="{TemplateBinding CornerRadius}">
						<Grid RowDefinitions="Auto,*">
							<Grid ColumnDefinitions="*,*,*,*" Margin="5,5,5,0">
								<TextBlock Grid.Column="0" Text="Mod" HorizontalAlignment="Center" VerticalAlignment="Center"/>
								<TextBlock Grid.Column="1" Text="Author" HorizontalAlignment="Center" VerticalAlignment="Center"/>
								<TextBlock Grid.Column="2" Text="Category" HorizontalAlignment="Center" VerticalAlignment="Center"/>
								<TextBlock Grid.Column="3" Text="Version" HorizontalAlignment="Center" VerticalAlignment="Center"/>
							</Grid>
							<ScrollViewer Name="PART_ScrollViewer" Grid.Row="1"
										  AllowAutoHide="{TemplateBinding (ScrollViewer.AllowAutoHide)}"
										  BringIntoViewOnFocusChange="{TemplateBinding (ScrollViewer.BringIntoViewOnFocusChange)}"
										  Background="{TemplateBinding Background}"
										  HorizontalScrollBarVisibility="{TemplateBinding (ScrollViewer.HorizontalScrollBarVisibility)}"
										  IsScrollChainingEnabled="{TemplateBinding (ScrollViewer.IsScrollChainingEnabled)}"
										  IsDeferredScrollingEnabled="{TemplateBinding (ScrollViewer.IsDeferredScrollingEnabled)}"
										  VerticalScrollBarVisibility="{TemplateBinding (ScrollViewer.VerticalScrollBarVisibility)}"
										  VerticalSnapPointsType="{TemplateBinding (ScrollViewer.VerticalSnapPointsType)}"
										  HorizontalSnapPointsType="{TemplateBinding (ScrollViewer.HorizontalSnapPointsType)}">
								<ItemsPresenter Name="PART_ItemsPresenter"
												Margin="{TemplateBinding Padding}"
												ItemsPanel="{TemplateBinding ItemsPanel}" />
							</ScrollViewer>
						</Grid>
					</Border>
				</ControlTemplate>
			</Setter>
		</ControlTheme>
	</Window.Resources>

	<dialogHostAvalonia:DialogHost CloseOnClickAway="True" BlurBackground="True">
		<dialogHostAvalonia:DialogHost.DialogContent>
			<Border Width="{Binding Path=$parent.Width, Converter={StaticResource DialogHostSizeConverter}}"
					Height="{Binding Path=$parent.Height, Converter={StaticResource DialogHostSizeConverter}}">
				
			</Border>
		</dialogHostAvalonia:DialogHost.DialogContent>
		
		<Grid RowDefinitions="*,Auto">
			<Grid>
				<TabControl x:Name="ManagerTabs" Theme="{DynamicResource MainWindowTabControl}" Width="{Binding Path=$parent[Window].Bounds.Width}">
					<TabItem Grid.Column="0" Header="{DynamicResource MainWindow.Mods}" Theme="{DynamicResource WindowTabItem}" TabIndex="0" Tag="{StaticResource ADVTheme.Icon.SonicHead}">
						<Grid ColumnDefinitions="*,Auto" Margin="10">
							<Grid RowDefinitions="500,Auto">
								<DataGrid x:Name="ModList" ItemsSource="{Binding ModEntries}" Margin="2,2,7,2" IsReadOnly="True" GridLinesVisibility="All"
										  CanUserReorderColumns="True" CanUserResizeColumns="True" CanUserSortColumns="True" CellTheme="{StaticResource ModEntryCell}"
										  BorderBrush="{DynamicResource ADVTheme.Brush.Border.Base}" BorderThickness="2" CornerRadius="{DynamicResource ADVTheme.CornerRadius}">
									<DataGrid.Columns>
										<DataGridTemplateColumn HeaderPointerPressed="DataGridTemplateColumn_HeaderPointerPressed">
											<DataGridTemplateColumn.HeaderTemplate>
												<DataTemplate>
													<Grid Width="18" HorizontalAlignment="Right">
														<Path HorizontalAlignment="Center" Data="{StaticResource ADVTheme.Icon.Plus}" Fill="{DynamicResource ADVTheme.Brush.Red.Base}"/>
													</Grid>
												</DataTemplate>
											</DataGridTemplateColumn.HeaderTemplate>
											<DataTemplate>
												<CheckBox IsChecked="{Binding IsEnabled}" HorizontalAlignment="Right" Margin="2"/>
											</DataTemplate>
										</DataGridTemplateColumn>
										<DataGridTextColumn Header="{DynamicResource Common.Name}" Binding="{Binding ModInfo.Name}" FontSize="{DynamicResource ADVTheme.FontSize}"/>
										<DataGridTextColumn Header="{DynamicResource Common.Author}" Binding="{Binding ModInfo.Author}" FontSize="{DynamicResource ADVTheme.FontSize}" />
										<DataGridTextColumn Header="{DynamicResource Common.Category}" Binding="{Binding ModInfo.Category}" FontSize="{DynamicResource ADVTheme.FontSize}"/>
										<DataGridTextColumn Header="{DynamicResource Common.Version}" Binding="{Binding ModInfo.Version}" FontSize="{DynamicResource ADVTheme.FontSize}"/>
									</DataGrid.Columns>
								</DataGrid>
								<Grid Grid.Row="1" ColumnDefinitions="Auto,*" Margin="7">
									<TextBlock Text="Description: "/>
									<TextBlock Grid.Column="1" Text="{Binding ElementName=ModList, Path=SelectedItem, Converter={StaticResource ModInfoDescriptionConverter}}"
											   TextWrapping="Wrap"/>
								</Grid>
							</Grid>
							<StackPanel Grid.Column="1" Margin="2" Orientation="Vertical" Spacing="5">
								<Button x:Name="Refresh" IsEnabled="{Binding Path=GameConfig, Converter={StaticResource ValidateGameConfigConverter}}" Command="{Binding RefreshModListCommand}">
									<Path Width="24" Data="{StaticResource ADVTheme.Icon.Refresh}" Fill="{DynamicResource ADVTheme.Brush.Highlight.Base}"/>
								</Button>
								<Button x:Name="AddMod" IsEnabled="{Binding Path=GameConfig, Converter={StaticResource ValidateGameConfigConverter}}">
									<Path Width="24" Data="{StaticResource ADVTheme.Icon.Plus}" Fill="{DynamicResource ADVTheme.Brush.Green.Base}"/>
								</Button>
								<Button x:Name="ConfigMod" IsEnabled="{Binding ElementName=ModList, Path=SelectedItem, Converter={StaticResource ModConfigConverter}}">
									<Path Width="24" Data="{StaticResource ADVTheme.Icon.Settings}" Fill="{DynamicResource ADVTheme.Brush.Gray.Base}"/>
								</Button>
							</StackPanel>
						</Grid>
					</TabItem>

					<TabItem Grid.Column="1" Header="{DynamicResource MainWindow.Codes}" Theme="{StaticResource WindowTabItem}" TabIndex="1" BorderThickness="0" Tag="{StaticResource ADVTheme.Icon.Plus}">

					</TabItem>

					<TabItem Grid.Column="2" Header="{DynamicResource MainWindow.GameConfig}" Theme="{StaticResource WindowTabItem}" TabIndex="2" BorderThickness="0" Tag="{StaticResource ADVTheme.Icon.Plus}">
					</TabItem>

					<TabItem Grid.Column="3" Header="{DynamicResource MainWindow.TestSpawn}" Theme="{StaticResource WindowTabItem}" TabIndex="3" BorderThickness="0" Tag="{StaticResource ADVTheme.Icon.Plus}">
					</TabItem>

					<TabItem Grid.Column="4" Header="{DynamicResource MainWindow.Settings}" Theme="{StaticResource WindowTabItem}" TabIndex="4" BorderThickness="0" Tag="{StaticResource ADVTheme.Icon.Plus}">
						<ScrollViewer AllowAutoHide="True">
							<Grid RowDefinitions="Auto,Auto,Auto">

							</Grid>
						</ScrollViewer>
					</TabItem>
				</TabControl>
				<Rectangle Fill="{DynamicResource ADVTheme.Brush.Highlight.Base}" Height="2" VerticalAlignment="Top" Margin="0,38,0,0"/>
			</Grid>

			<Grid Grid.Row="1" Margin="10" Height="45" ColumnDefinitions="Auto,*,Auto">
				<StackPanel Orientation="Horizontal" Spacing="10">
					<Button Width="180">
						<StackPanel Orientation="Horizontal" Spacing="5" >
							<Path Stroke="{DynamicResource ADVTheme.Brush.Highlight.Base}" StrokeThickness="0" Fill="{DynamicResource ADVTheme.Brush.Highlight.Base}" Data="{DynamicResource ADVTheme.Icon.Controller}" Margin="1"/>
							<TextBlock Text="{DynamicResource MainWindow.SaveAndPlay}" VerticalAlignment="Center"/>
						</StackPanel>
					</Button>
					<Button Width="180">
						<StackPanel Orientation="Horizontal" Spacing="5" >
							<Path Stroke="{DynamicResource ADVTheme.Brush.Highlight.Base}" StrokeThickness="0" Fill="{DynamicResource ADVTheme.Brush.Highlight.Base}" Data="{DynamicResource ADVTheme.Icon.VMU}" Margin="1"/>
							<TextBlock Text="{DynamicResource MainWindow.Save}" VerticalAlignment="Center"/>
						</StackPanel>
					</Button>
				</StackPanel>
				<ComboBox Grid.Column="2" SelectedIndex="0" MinWidth="180">
					<ComboBoxItem Content="Hello"/>
				</ComboBox>
			</Grid>
		</Grid>
	</dialogHostAvalonia:DialogHost>
</Window>
